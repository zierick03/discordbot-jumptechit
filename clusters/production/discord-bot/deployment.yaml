apiVersion: apps/v1               # Kubernetes API versie voor deployments
kind: Deployment                  # Type resource: Deployment
metadata:
  name: discord-bot               # Naam van deze deployment
  namespace: discord-bot          # Namespace waarin de bot draait
spec:
  replicas: 1                     # Aantal pods dat tegelijk moet draaien
  selector:
    matchLabels:
      app: discord-bot            # Labels om pods te matchen die bij deze deployment horen
  template:                       # Template voor de pod
    metadata:
      labels:
        app: discord-bot          # Label voor de pod, moet overeenkomen met selector
    spec:
      containers:
        - name: discord-bot       # Naam van de container
          image: ghcr.io/zierick03/discordbot-jumptechit:latest # Docker image van je bot
          imagePullPolicy: Always # Zorgt dat Kubernetes altijd de nieuwste versie probeert te pullen
          env:
            - name: DISCORD_TOKEN
              valueFrom:
                secretKeyRef:
                  name: discord-bot-secret  # Kubernetes secret waar het token in staat
                  key: token
      imagePullSecrets:            # Secret voor private Docker registry (GHCR)
        - name: ghcr-secret
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
              - matchExpressions:
                  - key: kubernetes.io/hostname  # Selecteer nodes waarop deze pod mag draaien
                    operator: In
                    values:
                      - pp-worker1             # Node 1 toegestaan
                      - pp-worker2             # Node 2 toegestaan
                      - pp-worker4             # Node 4 toegestaan








# apiVersion: apps/v1
# kind: Deployment
# metadata:
#   name: discord-bot
#   namespace: discord-bot
# spec:
#   replicas: 1
#   selector:
#     matchLabels:
#       app: discord-bot
#   template:
#     metadata:
#       labels:
#         app: discord-bot
#     spec:
#       containers:
#         - name: discord-bot
#           image: zierick03/discordbot:latest 
#           # ghcr.io/zierick03/discordbot-jumptechit:latest
#           imagePullPolicy: Always
#       affinity:
#         nodeAffinity:
#           requiredDuringSchedulingIgnoredDuringExecution:
#             nodeSelectorTerms:
#               - matchExpressions:
#                   - key: kubernetes.io/hostname
#                     operator: In
#                     values:
#                       - pp-worker1
#                       - pp-worker2
#                       - pp-worker4









# # apiVersion: apps/v1
# # kind: Deployment
# # metadata:
# #   name: discord-bot
# #   namespace: discord-bot
# # spec:
# #   replicas: 1
# #   selector:
# #     matchLabels:
# #       app: discord-bot
# #   template:
# #     metadata:
# #       labels:
# #         app: discord-bot
# #     spec:
# #       containers:
# #       - name: discord-bot
# #         image: ghcr.io/zierick03/discordbot-jumptechit:latest
# #         imagePullPolicy: Always
# #         env:
# #         - name: DISCORD_TOKEN
# #           valueFrom:
# #             secretKeyRef:
# #               name: discord-bot-secret
# #               key: token
